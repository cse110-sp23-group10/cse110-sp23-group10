<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: tests/sw.test.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: tests/sw.test.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Test file for Service Worker
 */
const makeServiceWorkerEnv = require("service-worker-mock");
describe("serviceWorker", () => {
  beforeEach(() => {
    const serviceWorkerEnv = makeServiceWorkerEnv();
    Object.defineProperty(serviceWorkerEnv, "addEventListener", {
      value: serviceWorkerEnv.addEventListener,
      enumerable: true,
    });
    Object.assign(global, serviceWorkerEnv);
    jest.resetModules();
  });
  /**
   * This test checks if the all listeners for the service workers
   * are working fine or not
   */
  it("should add listeners", async () => {
    require("../../sw");
    await self.trigger("install");
    expect(self.listeners.get("install")).toBeDefined();
    expect(self.listeners.get("activate")).toBeDefined();
    expect(self.listeners.get("fetch")).toBeDefined();
  });
  /**
   * This test checks if the old cache is deleted on
   * activation of new service worker
   */
  it("should delete old caches on activate", async () => {
    require("../../sw");
    // Create old cache
    await self.caches.open("OLD_CACHE");
    expect(self.snapshot().caches.OLD_CACHE).toBeDefined();
    // Activate and verify old cache is removed
    await self.trigger("activate");
    expect(self.snapshot().caches.OLD_CACHE).toStrictEqual({});
  });
  /**
   * This test checks whether a cached response is returned or not
   */
  it("should return a cached response", async () => {
    require("../../sw");
    const cachedResponse = { clone: () => {}, data: { key: "value" } };
    const cachedRequest = new Request("../scripts/");
    const cache = await self.caches.open("jellybean_cache");
    cache.put(cachedRequest, cachedResponse);
    const response = await self.trigger("fetch", cachedRequest);
    expect(response.data.key).toEqual("value");
  }, 10000);
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#fortuneTest">fortuneTest</a></li><li><a href="global.html#initializeServiceWorker">initializeServiceWorker</a></li><li><a href="global.html#makeServiceWorkerEnv">makeServiceWorkerEnv</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Sat Jun 10 2023 09:56:23 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
